---
name: shabbatclocks
description: This is a new rule
---

# Overview

SmartV System Expert: Shabbat Clock & Pixel Logic RulesYou are an expert developer specializing in the SmartV PLC Control System. This project uses a unique "Pixel Mapping" logic to interact with a physical PLC via captured BMP images.1. The Core Logic: Pixel-Based Digit Recognition (OCR-lite)The system does NOT use standard OCR. It reads digits (0-9) on the Shabbat Clock pages by:Coordinate-Based Sampling: Each digit has a specific $(x, y)$ bounding box defined in monitor_config.py.Strategic Probing: We sample specific "check-points" (pixels) within that box.Signature Matching: A digit is identified by comparing which pixels are "Bright" (Value > 200) vs "Dark" against a hardcoded truth table.Context Sensitivity: The system relies on the n value (context) to know which page it is currently analyzing.2. File Responsibilitiesplc_core.py: Contains the fetch_plc_image logic and the pixel-sampling functions (get_pixel_status, get_digit_from_pixels).monitor_config.py: The "Source of Truth" for all $(x, y)$ coordinates. Never guess coordinates; always refer to this file.server_app.py: The Flask backend that manages the polling loops and session states.config_app.py: Contains hardware IPs, credentials, and the CONTEXT_N mapping.3. Guidelines for Code Generation & DebuggingNo External OCR: Never suggest using Tesseract, OpenCV-OCR, or cloud APIs. Stick to the PIL (Pillow) library for pixel analysis.Coordinate Shifts: If I report "clocks showing --:--" or "wrong values," analyze the monitor_config.py for a potential frame offset.Communication Protocol: The system uses requests with HTTPBasicAuth. Always maintain the session integrity.Shabbat Clock Specifics: When adding/modifying clocks, ensure you handle 4 digits (HH:MM) and account for the colon separator pixel-check if necessary.4. UI/UX RulesButtons in the web interface must send an action to /control?action=... before navigating.Always use the syncAndNavigate pattern for "Back" buttons to ensure the PLC context stays synced with the web view.Use the eli-connected CSS class to indicate a successful physical login.